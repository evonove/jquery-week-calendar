<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <title>jQuery Week Calendar</title>

  <link rel="stylesheet" type="text/css" href="assets/components-bootstrap/css/bootstrap.css" />
  <link rel="stylesheet" type="text/css" href="assets/components-bootstrap/css/bootstrap-responsive.css" />
  <link rel="stylesheet" type="text/css" href="assets/font-awesome/css/font-awesome.css" />
  
  <link rel="stylesheet" type="text/css" href="assets/pickadate/lib/themes/classic.css" />
  <link rel="stylesheet" type="text/css" href="assets/pickadate/lib/themes/classic.date.css" />
  <link rel="stylesheet" type="text/css" href="assets/pickadate/lib/themes/classic.time.css" />
  <link rel="stylesheet" type="text/css" href="jquery.weekcalendar.css" />
  <!--link rel="stylesheet" type="text/css" href="mobile.css" /-->
</head>
<body>
  <div class="container-fluid fill">
    <div id="header" class="row-fluid">
      <!-- <h1>jQuery Week Calendar</h1>
      <p class="description">
        This calendar demonstrates the differents new options that allow user
        management and freebusy display / computation.
      </p>
    </div> -->
    <div id="calendar" />
  </div>

  <script type="text/javascript" src="assets/enquire/dist/enquire.js"></script>
  <script type="text/javascript" src="assets/jquery/jquery.js"></script>
  <script type="text/javascript" src="assets/jquery-ui/ui/jquery-ui.js"></script>


  <script type="text/javascript" src="assets/components-bootstrap/js/bootstrap.js"></script>
  <script type="text/javascript" src="assets/pickadate/lib/picker.js"></script>
  <script type="text/javascript" src="assets/pickadate/lib/picker.date.js"></script>
  <script type="text/javascript" src="assets/pickadate/lib/picker.time.js"></script>
  <script type="text/javascript" src="assets/moment/moment.js"></script>
  <script type="text/javascript" src="assets/iscroll/build/iscroll.js"></script>
  <script type="text/javascript" src="assets/hammerjs/dist/jquery.hammer.js"></script>
  <script type="text/javascript" src="jquery.weekcalendar.init.js"></script>
  <script type="text/javascript" src="compat.js"></script>
  <script type="text/javascript" src="utils.js"></script>
  <script type="text/javascript" src="popover.js"></script>
  <script type="text/javascript" src="jquery.weekcalendar.js"></script>

  <!-- Widget initialization -->
  <script type='text/javascript'>
    (function($) {
      var ajaxLoadedUsers = [{'id': 1, 'username': 'syn', 'first_name': '', 'last_name': '', 'email': '1@1.it', 'last_login': '2013-07-08T09:52:48.619Z', 'date_joined': '2013-05-09T10:17:27.875Z', 'organizations': [1, 2]}, {'id': 2, 'username': 'pippo', 'first_name': '', 'last_name': '', 'email': '', 'last_login': '2013-07-08T10:13:30.215Z', 'date_joined': '2013-07-08T10:13:30.215Z', 'organizations': [1]}, {'id': 3, 'username': 'pluto', 'first_name': '', 'last_name': '', 'email': '', 'last_login': '2013-07-08T10:13:30.215Z', 'date_joined': '2013-07-08T10:13:30.215Z', 'organizations': [1]}, {'id': 4, 'username': 'topolino', 'first_name': '', 'last_name': '', 'email': '', 'last_login': '2013-07-08T10:13:30.215Z', 'date_joined': '2013-07-08T10:13:30.215Z', 'organizations': [1]}, {'id': 5, 'username': 'paperino', 'first_name': '', 'last_name': '', 'email': '', 'last_login': '2013-07-08T10:13:30.215Z', 'date_joined': '2013-07-08T10:13:30.215Z', 'organizations': [1,2]}, {'id': 22, 'username': 'paperone', 'first_name': '', 'last_name': '', 'email': '', 'last_login': '2013-07-08T10:13:30.215Z', 'date_joined': '2013-07-08T10:13:30.215Z', 'organizations': [2]}, {'id': 23, 'username': 'bassotto1', 'first_name': '', 'last_name': '', 'email': '', 'last_login': '2013-07-08T10:13:30.215Z', 'date_joined': '2013-07-08T10:13:30.215Z', 'organizations': [2]}, {'id': 24, 'username': 'bassotto2', 'first_name': '', 'last_name': '', 'email': '', 'last_login': '2013-07-08T10:13:30.215Z', 'date_joined': '2013-07-08T10:13:30.215Z', 'organizations': [2]}, {'id': 25, 'username': 'bassotto3', 'first_name': '', 'last_name': '', 'email': '', 'last_login': '2013-07-08T10:13:30.215Z', 'date_joined': '2013-07-08T10:13:30.215Z', 'organizations': [2]}, {'id': 26, 'username': 'bassotto4', 'first_name': '', 'last_name': '', 'email': '', 'last_login': '2013-07-08T10:13:30.215Z', 'date_joined': '2013-07-08T10:13:30.215Z', 'organizations': [2]}];

      // var ajaxLoadedUsers = [{'id': 1, 'username': 'syn', 'first_name': '', 'last_name': '', 'email': '1@1.it', 'last_login': '2013-07-08T09:52:48.619Z', 'date_joined': '2013-05-09T10:17:27.875Z', 'organizations': [1, 2]}];
      var conf = {
        users: ajaxLoadedUsers,
        loadedUsers: ajaxLoadedUsers,
        removedUserIds: [],
        showAsSeparateUsers: true,
        organizations : [{'id': 1, 'name': 'Evonove', 'users': [1, 2, 3, 4, 5]}, {'id': 2, 'name': 'AmatoriNuoto', 'users': [1, 5, 22]}]
      };
      TimelyUi.init('calendar', conf);
    })(jQuery);
  </script>
  <script type="text/javascript">
 /*!
 * jQuery UI Touch Punch 0.2.2
 *
 * Copyright 2011, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
(function ($) {

  // Detect touch support
  $.support.touch = 'ontouchend' in document;

  // Ignore browsers without touch support
  if (!$.support.touch) {
    return;
  }

  var mouseProto = $.ui.mouse.prototype,
      _mouseInit = mouseProto._mouseInit,
      touchHandled;

  /**
   * Simulate a mouse event based on a corresponding touch event
   * @param {Object} event A touch event
   * @param {String} simulatedType The corresponding mouse event
   */
  function simulateMouseEvent (event, simulatedType) {

    // Ignore multi-touch events
    if (event.originalEvent.touches.length > 1) {
      return;
    }

    event.preventDefault();

    var touch = event.originalEvent.changedTouches[0],
        simulatedEvent = document.createEvent('MouseEvents');
    
    // Initialize the simulated mouse event using the touch event's coordinates
    simulatedEvent.initMouseEvent(
      simulatedType,    // type
      true,             // bubbles                    
      true,             // cancelable                 
      window,           // view                       
      1,                // detail                     
      touch.screenX,    // screenX                    
      touch.screenY,    // screenY                    
      touch.clientX,    // clientX                    
      touch.clientY,    // clientY                    
      false,            // ctrlKey                    
      false,            // altKey                     
      false,            // shiftKey                   
      false,            // metaKey                    
      0,                // button                     
      null              // relatedTarget              
    );
    // Dispatch the simulated event to the target element
    event.target.dispatchEvent(simulatedEvent);
  }

  /**
   * Handle the jQuery UI widget's touchstart events
   * @param {Object} event The widget element's touchstart event
   */
  mouseProto._touchStart = function (event) {
    var self = this;

    // Ignore the event if another widget is already being handled
    if (touchHandled || !self._mouseCapture(event.originalEvent.changedTouches[0])) {
      return;
    }

    // Set the flag to prevent other widgets from inheriting the touch event
    touchHandled = true;

    // Track movement to determine if interaction was a click
    self._touchMoved = false;

    // Simulate the mouseover event
    simulateMouseEvent(event, 'mouseover');

    // Simulate the mousemove event
    simulateMouseEvent(event, 'mousemove');

    // caching the current x
    cachedX = event.pageX;
    // caching the current y
    cachedY = event.pageY;

    //start move of drag after an hold touch
    setTimeout(function (){
        currX = event.pageX;
        currY = event.pageY;
        if ((cachedX === currX) && !self._touchMoved && (cachedY === currY)) {
            // Here you get the hold event, cast mousedown
            // Simulate the mousedown event
            simulateMouseEvent(event, 'mousedown');
        }
    },200);
    this.lastMove = this.lastMove || new Date().getTime();

  };

  /**
   * Handle the jQuery UI widget's touchmove events
   * @param {Object} event The document's touchmove event
   */
  mouseProto._touchMove = function (event) {
    // Ignore event if not handled
    if (!touchHandled) {
      return;
    }

    // Interaction was not a click
    this._touchMoved = true;

    // Simulate the mousemove event
    simulateMouseEvent(event, 'mousemove');
  };

  /**
   * Handle the jQuery UI widget's touchend events
   * @param {Object} event The document's touchend event
   */
  mouseProto._touchEnd = function (event) {
    console.log('_touchEnd');
    // TimelyUi.utils.enableIScrolls();
    // TimelyUi.utils.isDraggingEvent = false;
    // Ignore event if not handled
    if (!touchHandled) {
      return;
    }

    // Simulate the mouseup event
    simulateMouseEvent(event, 'mouseup');

    // Simulate the mouseout event
    simulateMouseEvent(event, 'mouseout');

    // If the touch interaction did not move, it should trigger a click
    if (!this._touchMoved) {

      // Simulate the click event
      simulateMouseEvent(event, 'click');
    }

    // Unset the flag to allow other widgets to inherit the touch event
    touchHandled = false;
  };

  /**
   * A duck punch of the $.ui.mouse _mouseInit method to support touch events.
   * This method extends the widget with bound touch event handlers that
   * translate touch events to mouse events and pass them to the widget's
   * original mouse event handling methods.
   */
  mouseProto._mouseInit = function () {
    
    var self = this;

    // Delegate the touch handlers to the widget's element
    self.element
      .bind('touchstart', $.proxy(self, '_touchStart'))
      .bind('touchmove', $.proxy(self, '_touchMove'))
      .bind('touchend', $.proxy(self, '_touchEnd'));

    // Call the original $.ui.mouse init method
    _mouseInit.call(self);
  };

})(jQuery);
</script>
</body>
</html>